<%- require 'json'
config_file= {}
role_key = @version >= '0.4.0' ? 'tag' : 'role'
config_file[role_key] = @role if @role
config_file['node_name'] = @node if @node
bind_key = @version >= '0.3.0' ? 'bind' : 'bind_addr'
config_file[bind_key] = @bind
config_file['advertise'] = @advertise if @advertise
config_file['encrypt_key'] = @encrypt_key if @encrypt_key
config_file['log_level'] = @log_level if @log_level
config_file['protocol'] = @protocol_version.to_i if @protocol_version
config_file['rpc_addr'] = @rpc_addr if @rpc_addr
config_file['event_handlers'] = @event_handler unless @event_handler.empty?
config_file['start_join'] = @join unless @join.empty?
-%>
<%=JSON.generate(config_file)%>
